(self["webpackChunkwebpackproject"] = self["webpackChunkwebpackproject"] || []).push([["getAndUpdateFirebaseData"],{

/***/ "./src/Admin_OrderListView/getAndUpdateFirebaseData.js":
/*!*************************************************************!*\
  !*** ./src/Admin_OrderListView/getAndUpdateFirebaseData.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _Index_Page_fireStoreAccess_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Index_Page/fireStoreAccess.js */ "./src/Index_Page/fireStoreAccess.js");
/* harmony import */ var _orderListStyling_css__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./orderListStyling.css */ "./src/Admin_OrderListView/orderListStyling.css");
/* harmony import */ var _Index_Page_addDataToLocalStorageFromFirebase__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Index_Page/addDataToLocalStorageFromFirebase */ "./src/Index_Page/addDataToLocalStorageFromFirebase.js");




window.onload = function () {
  //On Page Load make the Checkboxes true by default
  showOrdersList(); //Making the Parent CheckBox toggle between checked and unchecked based on
  //whether all the child checkboxes are checked or not

  setTimeout(function () {
    var tbodyQueue = document.getElementsByTagName("tbody");

    for (var key = 0; key < tbodyQueue.length; key++) {
      tbodyQueue[key].addEventListener("change", function (event) {
        if (event.target.parentElement.id) {
          var parentCheckBoxId = event.target.name + "CheckBox";

          if (event.target.checked == false) {
            document.getElementById(parentCheckBoxId).checked = false;
          } else {
            var flag = 0;
            var orders = document.getElementsByName(event.target.name);
            orders.forEach(function (order) {
              if (!order.id && flag != 1) {
                if (order.checked == true) flag = 0;else flag = 1;
              }
            });
            if (flag == 0) document.getElementById(parentCheckBoxId).checked = true;
          }
        }
      });
    }
  }, 3000);
};

function showOrdersList() {
  var inTheQueue = document.getElementById("inTheQueue");
  var beingMixed = document.getElementById("beingMixed");
  var readyToCollect = document.getElementById("readyToCollect");
  inTheQueue.checked = true;
  beingMixed.checked = true;
  readyToCollect.checked = true;
  handleData(inTheQueue)();
  handleData(beingMixed)();
  handleData(readyToCollect)();
}

var showCheckBoxes = toggleCheckBoxes();
document.getElementById("selectQueue").addEventListener("click", showCheckBoxes); //Toggles between showing and hiding the checkboxes

function toggleCheckBoxes() {
  var show = true;
  return function () {
    var checkBoxQueues = document.getElementById("checkBoxQueues");

    if (show) {
      checkBoxQueues.style.display = "block";
      show = false;
    } else {
      checkBoxQueues.style.display = "none";
      show = true;
    }
  };
} //Select all CheckBoxes of the respective queue by clicking one main CheckBox


function checkAll(checkbox) {
  return function () {
    if (checkbox.checked === true) {
      var queue = document.getElementsByName(checkbox.name);
      queue.forEach(function (element) {
        element.checked = true;
      });
    } else {
      var _queue = document.getElementsByName(checkbox.name);

      _queue.forEach(function (element) {
        element.checked = false;
      });
    }
  };
} //Get Data from Firebase and store it in your table


function handleData(checkbox) {
  return function () {
    var customersData = JSON.parse(localStorage.getItem("customersData"));
    var customerOrders = customersData[0];
    var orderQueue = customersData[1];
    var customerIDs = Object.keys(customerOrders); //If Checked 

    if (checkbox.checked == true) {
      //The Queue in which the data belong to
      var queue = checkbox.id; //Create a Row representing the Customer Data in particular Queue

      var customersQueueData = document.createElement("tbody");
      customersQueueData.id = queue + "Row";
      document.getElementById("ordersList").appendChild(customersQueueData); //Creating a table cell representing the Queue Name and a Checkbox

      var queueNameRow = document.createElement("tr");
      customersQueueData.appendChild(queueNameRow);
      var queueNameCell = document.createElement("td");
      queueNameRow.appendChild(queueNameCell);
      queueNameCell.colSpan = 4; //Label

      var queueNameLabel = document.createElement("LABEL");
      queueNameLabel.htmlFor = queue + "CheckBox";
      if (queue == "inTheQueue") queueNameLabel.innerHTML = "In The Queue ";else if (queue == "beingMixed") queueNameLabel.innerHTML = "Being Mixed ";else queueNameLabel.innerHTML = "Ready To Collect ";
      queueNameCell.appendChild(queueNameLabel); //CheckBox

      var queueNameCheckBox = document.createElement("input");
      queueNameCheckBox.type = "checkbox";
      queueNameCheckBox.name = queue;
      queueNameCheckBox.id = queue + "CheckBox";
      queueNameCheckBox.style.verticalAlign = "middle";
      var checkAllFunction = checkAll(queueNameCheckBox);
      queueNameCheckBox.addEventListener("change", checkAllFunction);
      queueNameCell.appendChild(queueNameCheckBox); //Create a Table Row for each Customer Order in a specific Queue

      customerIDs.forEach(function (id) {
        if (orderQueue[id] === checkbox.id) {
          //Get Cutomer Name and Order based on his ID
          var customerData = customerOrders[id];
          var customerDataArray = customerData.split("$");
          var customerName = customerDataArray[0];
          var beverage = customerDataArray[1]; //ROW

          var customerRow = document.createElement("tr");
          rowID = orderQueue[id] + "Row";
          document.getElementById(rowID).appendChild(customerRow); //ID

          var ID = document.createElement("td");
          ID.innerHTML = id;
          customerRow.appendChild(ID); //Name

          var name = document.createElement("td");
          name.innerHTML = customerName;
          customerRow.appendChild(name); //Beverage

          var drink = document.createElement("td");
          drink.innerHTML = beverage;
          customerRow.appendChild(drink); //CheckBox

          var selectData = document.createElement("td");
          selectData.id = id;
          customerRow.appendChild(selectData);
          var inputCheckBox = document.createElement("input");
          inputCheckBox.type = "checkbox";
          inputCheckBox.name = orderQueue[id];
          selectData.appendChild(inputCheckBox);
        }
      });
    } //If Unchecked
    else {
        var rowID = checkbox.id + "Row";
        var orders = document.getElementById(rowID);
        orders.remove();
        count = 0;
      }
  };
}

var inTheQueueFunction = handleData(document.getElementById("inTheQueue"));
var beingMixedFunction = handleData(document.getElementById("beingMixed"));
var readyToCollectFunction = handleData(document.getElementById("readyToCollect"));
document.getElementById("inTheQueue").addEventListener("change", inTheQueueFunction);
document.getElementById("beingMixed").addEventListener("change", beingMixedFunction);
document.getElementById("readyToCollect").addEventListener("change", readyToCollectFunction); // Shift all the checked orders to the selected Queue

function shiftToSelectedQueue() {
  _Index_Page_fireStoreAccess_js__WEBPACK_IMPORTED_MODULE_0__.database.collection("customers").get().then(function (snapshot) {
    var doc = snapshot.docs[0];
    var docId = doc.id;
    var customersData = doc.data().customersData;
    var customerOrders = customersData[0];
    var orderQueue = customersData[1];
    var currentCustomersCount = doc.data().currentCustomersCount;
    var index = doc.data().index;
    var queueName = document.getElementById("shiftToQueue").value;
    var selectedOrders = document.querySelectorAll("input[type='checkbox']:checked");
    selectedOrders.forEach(function (element) {
      if (element.parentElement.id && queueName != "--Shift To Queue--") {
        var customerId = element.parentElement.id;
        customerId = parseInt(customerId);

        if (queueName != "deleteOrder") {
          //Update the customerId with new queueName
          delete orderQueue[customerId];
          orderQueue[index] = queueName; //Delete the customerData and update to new one

          var customerData = customerOrders[customerId];
          delete customerOrders[customerId];
          customerOrders[index] = customerData;
          localStorage.setItem("customersData", JSON.stringify(customersData)); //Update the index count in Firestore

          index++;
          localStorage.setItem("index", index);
          _Index_Page_fireStoreAccess_js__WEBPACK_IMPORTED_MODULE_0__.database.collection("customers").doc(docId).update({
            customersData: customersData,
            index: index
          }).then(function () {
            location.reload();
          });
        } else {
          //Delete the customer's data from Firestore
          delete customerOrders[customerId];
          delete orderQueue[customerId];
          localStorage.setItem("customersData", JSON.stringify(customersData));
          currentCustomersCount--;
          localStorage.setItem("currentCustomersCount", currentCustomersCount);
          _Index_Page_fireStoreAccess_js__WEBPACK_IMPORTED_MODULE_0__.database.collection("customers").doc(docId).update({
            customersData: customersData,
            currentCustomersCount: currentCustomersCount
          }).then(function () {
            location.reload();
          });
        }
      }
    });
  });
}

document.getElementById("updateLocalStorage").addEventListener("click", shiftToSelectedQueue);

/***/ }),

/***/ "./src/Index_Page/addDataToLocalStorageFromFirebase.js":
/*!*************************************************************!*\
  !*** ./src/Index_Page/addDataToLocalStorageFromFirebase.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _Index_Page_fireStoreAccess_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Index_Page/fireStoreAccess.js */ "./src/Index_Page/fireStoreAccess.js");

_Index_Page_fireStoreAccess_js__WEBPACK_IMPORTED_MODULE_0__.database.collection("customers").get().then(function (snapshot) {
  var doc = snapshot.docs[0];
  var customersData = doc.data().customersData;
  var currentCustomersCount = doc.data().currentCustomersCount;
  var index = doc.data().index;
  addToLocalStorage(customersData, currentCustomersCount, index);

  function addToLocalStorage(customersData, currentCustomersCount, index) {
    localStorage.setItem("customersData", JSON.stringify(customersData));
    localStorage.setItem("index", index);
    localStorage.setItem("currentCustomersCount", currentCustomersCount);
  }
});

/***/ }),

/***/ "./src/Admin_OrderListView/orderListStyling.css":
/*!******************************************************!*\
  !*** ./src/Admin_OrderListView/orderListStyling.css ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
// extracted by mini-css-extract-plugin


/***/ })

},
0,[["./src/Admin_OrderListView/getAndUpdateFirebaseData.js","runtime","vendors-node_modules_firebase_app_dist_index_esm_js-node_modules_firebase_firestore_dist_inde-439294","sharedFireStoreAccess"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJwYWNrcHJvamVjdC8uL3NyYy9BZG1pbl9PcmRlckxpc3RWaWV3L2dldEFuZFVwZGF0ZUZpcmViYXNlRGF0YS5qcyIsIndlYnBhY2s6Ly93ZWJwYWNrcHJvamVjdC8uL3NyYy9JbmRleF9QYWdlL2FkZERhdGFUb0xvY2FsU3RvcmFnZUZyb21GaXJlYmFzZS5qcyIsIndlYnBhY2s6Ly93ZWJwYWNrcHJvamVjdC8uL3NyYy9BZG1pbl9PcmRlckxpc3RWaWV3L29yZGVyTGlzdFN0eWxpbmcuY3NzPzc4ZDciXSwibmFtZXMiOlsid2luZG93Iiwib25sb2FkIiwic2hvd09yZGVyc0xpc3QiLCJzZXRUaW1lb3V0IiwidGJvZHlRdWV1ZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJrZXkiLCJsZW5ndGgiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJ0YXJnZXQiLCJwYXJlbnRFbGVtZW50IiwiaWQiLCJwYXJlbnRDaGVja0JveElkIiwibmFtZSIsImNoZWNrZWQiLCJnZXRFbGVtZW50QnlJZCIsImZsYWciLCJvcmRlcnMiLCJnZXRFbGVtZW50c0J5TmFtZSIsImZvckVhY2giLCJvcmRlciIsImluVGhlUXVldWUiLCJiZWluZ01peGVkIiwicmVhZHlUb0NvbGxlY3QiLCJoYW5kbGVEYXRhIiwic2hvd0NoZWNrQm94ZXMiLCJ0b2dnbGVDaGVja0JveGVzIiwic2hvdyIsImNoZWNrQm94UXVldWVzIiwic3R5bGUiLCJkaXNwbGF5IiwiY2hlY2tBbGwiLCJjaGVja2JveCIsInF1ZXVlIiwiZWxlbWVudCIsImN1c3RvbWVyc0RhdGEiLCJKU09OIiwicGFyc2UiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiY3VzdG9tZXJPcmRlcnMiLCJvcmRlclF1ZXVlIiwiY3VzdG9tZXJJRHMiLCJPYmplY3QiLCJrZXlzIiwiY3VzdG9tZXJzUXVldWVEYXRhIiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZENoaWxkIiwicXVldWVOYW1lUm93IiwicXVldWVOYW1lQ2VsbCIsImNvbFNwYW4iLCJxdWV1ZU5hbWVMYWJlbCIsImh0bWxGb3IiLCJpbm5lckhUTUwiLCJxdWV1ZU5hbWVDaGVja0JveCIsInR5cGUiLCJ2ZXJ0aWNhbEFsaWduIiwiY2hlY2tBbGxGdW5jdGlvbiIsImN1c3RvbWVyRGF0YSIsImN1c3RvbWVyRGF0YUFycmF5Iiwic3BsaXQiLCJjdXN0b21lck5hbWUiLCJiZXZlcmFnZSIsImN1c3RvbWVyUm93Iiwicm93SUQiLCJJRCIsImRyaW5rIiwic2VsZWN0RGF0YSIsImlucHV0Q2hlY2tCb3giLCJyZW1vdmUiLCJjb3VudCIsImluVGhlUXVldWVGdW5jdGlvbiIsImJlaW5nTWl4ZWRGdW5jdGlvbiIsInJlYWR5VG9Db2xsZWN0RnVuY3Rpb24iLCJzaGlmdFRvU2VsZWN0ZWRRdWV1ZSIsImRhdGFiYXNlIiwiZ2V0IiwidGhlbiIsInNuYXBzaG90IiwiZG9jIiwiZG9jcyIsImRvY0lkIiwiZGF0YSIsImN1cnJlbnRDdXN0b21lcnNDb3VudCIsImluZGV4IiwicXVldWVOYW1lIiwidmFsdWUiLCJzZWxlY3RlZE9yZGVycyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjdXN0b21lcklkIiwicGFyc2VJbnQiLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwidXBkYXRlIiwibG9jYXRpb24iLCJyZWxvYWQiLCJhZGRUb0xvY2FsU3RvcmFnZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTs7QUFFQUEsTUFBTSxDQUFDQyxNQUFQLEdBQWdCLFlBQVc7QUFDdkI7QUFDQUMsZ0JBQWMsR0FGUyxDQUl2QjtBQUNBOztBQUNBQyxZQUFVLENBQUMsWUFBTTtBQUNiLFFBQUlDLFVBQVUsR0FBR0MsUUFBUSxDQUFDQyxvQkFBVCxDQUE4QixPQUE5QixDQUFqQjs7QUFDQSxTQUFLLElBQUlDLEdBQUcsR0FBRyxDQUFmLEVBQWtCQSxHQUFHLEdBQUdILFVBQVUsQ0FBQ0ksTUFBbkMsRUFBMkNELEdBQUcsRUFBOUMsRUFBa0Q7QUFD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QWIsQ0FBcUIsdUJBQXJCLEVBQThDUixxQkFBOUM7QUFDSDtBQUNKLENBWkQsRTs7Ozs7Ozs7Ozs7O0FDREEiLCJmaWxlIjoiZ2V0QW5kVXBkYXRlRmlyZWJhc2VEYXRhLmJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRhdGFiYXNlIH0gZnJvbSAnLi4vSW5kZXhfUGFnZS9maXJlU3RvcmVBY2Nlc3MuanMnO1xyXG5pbXBvcnQgJy4vb3JkZXJMaXN0U3R5bGluZy5jc3MnO1xyXG5pbXBvcnQgJy4uL0luZGV4X1BhZ2UvYWRkRGF0YVRvTG9jYWxTdG9yYWdlRnJvbUZpcmViYXNlJztcclxuXHJcbndpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuICAgIC8vT24gUGFnZSBMb2FkIG1ha2UgdGhlIENoZWNrYm94ZXMgdHJ1ZSBieSBkZWZhdWx0XHJcbiAgICBzaG93T3JkZXJzTGlzdCgpO1xyXG5cclxuICAgIC8vTWFraW5nIHRoZSBQYXJlbnQgQ2hlY2tCb3ggdG9nZ2xlIGJldHdlZW4gY2hlY2tlZCBhbmQgdW5jaGVja2VkIGJhc2VkIG9uXHJcbiAgICAvL3doZXRoZXIgYWxsIHRoZSBjaGlsZCBjaGVja2JveGVzIGFyZSBjaGVja2VkIG9yIG5vdFxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgbGV0IHRib2R5UXVldWUgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRib2R5XCIpO1xyXG4gICAgICAgIGZvciAobGV0IGtleSA9IDA7IGtleSA8IHRib2R5UXVldWUubGVuZ3RoOyBrZXkrKykge1xyXG4gICAgICAgICAgICB0Ym9keVF1ZXVlW2tleV0uYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCAoZXZlbnQpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQucGFyZW50RWxlbWVudC5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBwYXJlbnRDaGVja0JveElkID0gZXZlbnQudGFyZ2V0Lm5hbWUgKyBcIkNoZWNrQm94XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jaGVja2VkID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHBhcmVudENoZWNrQm94SWQpLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZmxhZyA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvcmRlcnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZShldmVudC50YXJnZXQubmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVycy5mb3JFYWNoKChvcmRlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvcmRlci5pZCAmJiBmbGFnICE9IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3JkZXIuY2hlY2tlZCA9PSB0cnVlKSBmbGFnID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGZsYWcgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZsYWcgPT0gMCkgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocGFyZW50Q2hlY2tCb3hJZCkuY2hlY2tlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9LCAzMDAwKTtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIHNob3dPcmRlcnNMaXN0KCkge1xyXG4gICAgbGV0IGluVGhlUXVldWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImluVGhlUXVldWVcIik7XHJcbiAgICBsZXQgYmVpbmdNaXhlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmVpbmdNaXhlZFwiKTtcclxuICAgIGxldCByZWFkeVRvQ29sbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVhZHlUb0NvbGxlY3RcIik7XHJcbiAgICBpblRoZVF1ZXVlLmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgYmVpbmdNaXhlZC5jaGVja2VkID0gdHJ1ZTtcclxuICAgIHJlYWR5VG9Db2xsZWN0LmNoZWNrZWQgPSB0cnVlO1xyXG5cclxuXHJcbiAgICBoYW5kbGVEYXRhKGluVGhlUXVldWUpKCk7XHJcbiAgICBoYW5kbGVEYXRhKGJlaW5nTWl4ZWQpKCk7XHJcbiAgICBoYW5kbGVEYXRhKHJlYWR5VG9Db2xsZWN0KSgpO1xyXG59XHJcblxyXG5cclxuXHJcblxyXG5jb25zdCBzaG93Q2hlY2tCb3hlcyA9IHRvZ2dsZUNoZWNrQm94ZXMoKTtcclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWxlY3RRdWV1ZVwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgc2hvd0NoZWNrQm94ZXMpO1xyXG5cclxuLy9Ub2dnbGVzIGJldHdlZW4gc2hvd2luZyBhbmQgaGlkaW5nIHRoZSBjaGVja2JveGVzXHJcbmZ1bmN0aW9uIHRvZ2dsZUNoZWNrQm94ZXMoKSB7XHJcbiAgICBsZXQgc2hvdyA9IHRydWU7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IGNoZWNrQm94UXVldWVzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjaGVja0JveFF1ZXVlc1wiKTtcclxuICAgICAgICBpZiAoc2hvdykge1xyXG4gICAgICAgICAgICBjaGVja0JveFF1ZXVlcy5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgICAgICBzaG93ID0gZmFsc2U7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY2hlY2tCb3hRdWV1ZXMuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgICAgICBzaG93ID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vU2VsZWN0IGFsbCBDaGVja0JveGVzIG9mIHRoZSByZXNwZWN0aXZlIHF1ZXVlIGJ5IGNsaWNraW5nIG9uZSBtYWluIENoZWNrQm94XHJcbmZ1bmN0aW9uIGNoZWNrQWxsKGNoZWNrYm94KSB7XHJcbiAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgIGlmIChjaGVja2JveC5jaGVja2VkID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIGxldCBxdWV1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKGNoZWNrYm94Lm5hbWUpO1xyXG4gICAgICAgICAgICBxdWV1ZS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5jaGVja2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGV0IHF1ZXVlID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUoY2hlY2tib3gubmFtZSk7XHJcbiAgICAgICAgICAgIHF1ZXVlLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4vL0dldCBEYXRhIGZyb20gRmlyZWJhc2UgYW5kIHN0b3JlIGl0IGluIHlvdXIgdGFibGVcclxuZnVuY3Rpb24gaGFuZGxlRGF0YShjaGVja2JveCkge1xyXG4gICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICB2YXIgY3VzdG9tZXJzRGF0YSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjdXN0b21lcnNEYXRhXCIpKTtcclxuICAgICAgICB2YXIgY3VzdG9tZXJPcmRlcnMgPSBjdXN0b21lcnNEYXRhWzBdO1xyXG4gICAgICAgIHZhciBvcmRlclF1ZXVlID0gY3VzdG9tZXJzRGF0YVsxXTtcclxuICAgICAgICB2YXIgY3VzdG9tZXJJRHMgPSBPYmplY3Qua2V5cyhjdXN0b21lck9yZGVycyk7XHJcbiAgICAgICAgLy9JZiBDaGVja2VkIFxyXG4gICAgICAgIGlmIChjaGVja2JveC5jaGVja2VkID09IHRydWUpIHtcclxuICAgICAgICAgICAgLy9UaGUgUXVldWUgaW4gd2hpY2ggdGhlIGRhdGEgYmVsb25nIHRvXHJcbiAgICAgICAgICAgIHZhciBxdWV1ZSA9IGNoZWNrYm94LmlkO1xyXG5cclxuICAgICAgICAgICAgLy9DcmVhdGUgYSBSb3cgcmVwcmVzZW50aW5nIHRoZSBDdXN0b21lciBEYXRhIGluIHBhcnRpY3VsYXIgUXVldWVcclxuICAgICAgICAgICAgdmFyIGN1c3RvbWVyc1F1ZXVlRGF0YSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0Ym9keVwiKTtcclxuICAgICAgICAgICAgY3VzdG9tZXJzUXVldWVEYXRhLmlkID0gcXVldWUgKyBcIlJvd1wiO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm9yZGVyc0xpc3RcIikuYXBwZW5kQ2hpbGQoY3VzdG9tZXJzUXVldWVEYXRhKTtcclxuXHJcbiAgICAgICAgICAgIC8vQ3JlYXRpbmcgYSB0YWJsZSBjZWxsIHJlcHJlc2VudGluZyB0aGUgUXVldWUgTmFtZSBhbmQgYSBDaGVja2JveFxyXG4gICAgICAgICAgICB2YXIgcXVldWVOYW1lUm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRyXCIpO1xyXG4gICAgICAgICAgICBjdXN0b21lcnNRdWV1ZURhdGEuYXBwZW5kQ2hpbGQocXVldWVOYW1lUm93KTtcclxuICAgICAgICAgICAgdmFyIHF1ZXVlTmFtZUNlbGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGRcIik7XHJcbiAgICAgICAgICAgIHF1ZXVlTmFtZVJvdy5hcHBlbmRDaGlsZChxdWV1ZU5hbWVDZWxsKTtcclxuICAgICAgICAgICAgcXVldWVOYW1lQ2VsbC5jb2xTcGFuID0gNDtcclxuICAgICAgICAgICAgLy9MYWJlbFxyXG4gICAgICAgICAgICB2YXIgcXVldWVOYW1lTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiTEFCRUxcIik7XHJcbiAgICAgICAgICAgIHF1ZXVlTmFtZUxhYmVsLmh0bWxGb3IgPSBxdWV1ZSArIFwiQ2hlY2tCb3hcIjtcclxuICAgICAgICAgICAgaWYgKHF1ZXVlID09IFwiaW5UaGVRdWV1ZVwiKSBxdWV1ZU5hbWVMYWJlbC5pbm5lckhUTUwgPSBcIkluIFRoZSBRdWV1ZSBcIjtcclxuICAgICAgICAgICAgZWxzZSBpZiAocXVldWUgPT0gXCJiZWluZ01peGVkXCIpIHF1ZXVlTmFtZUxhYmVsLmlubmVySFRNTCA9IFwiQmVpbmcgTWl4ZWQgXCI7XHJcbiAgICAgICAgICAgIGVsc2UgcXVldWVOYW1lTGFiZWwuaW5uZXJIVE1MID0gXCJSZWFkeSBUbyBDb2xsZWN0IFwiO1xyXG4gICAgICAgICAgICBxdWV1ZU5hbWVDZWxsLmFwcGVuZENoaWxkKHF1ZXVlTmFtZUxhYmVsKTtcclxuICAgICAgICAgICAgLy9DaGVja0JveFxyXG4gICAgICAgICAgICB2YXIgcXVldWVOYW1lQ2hlY2tCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcbiAgICAgICAgICAgIHF1ZXVlTmFtZUNoZWNrQm94LnR5cGUgPSBcImNoZWNrYm94XCI7XHJcbiAgICAgICAgICAgIHF1ZXVlTmFtZUNoZWNrQm94Lm5hbWUgPSBxdWV1ZTtcclxuICAgICAgICAgICAgcXVldWVOYW1lQ2hlY2tCb3guaWQgPSBxdWV1ZSArIFwiQ2hlY2tCb3hcIjtcclxuICAgICAgICAgICAgcXVldWVOYW1lQ2hlY2tCb3guc3R5bGUudmVydGljYWxBbGlnbiA9IFwibWlkZGxlXCI7XHJcbiAgICAgICAgICAgIGxldCBjaGVja0FsbEZ1bmN0aW9uID0gY2hlY2tBbGwocXVldWVOYW1lQ2hlY2tCb3gpO1xyXG4gICAgICAgICAgICBxdWV1ZU5hbWVDaGVja0JveC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGNoZWNrQWxsRnVuY3Rpb24pO1xyXG4gICAgICAgICAgICBxdWV1ZU5hbWVDZWxsLmFwcGVuZENoaWxkKHF1ZXVlTmFtZUNoZWNrQm94KTtcclxuXHJcbiAgICAgICAgICAgIC8vQ3JlYXRlIGEgVGFibGUgUm93IGZvciBlYWNoIEN1c3RvbWVyIE9yZGVyIGluIGEgc3BlY2lmaWMgUXVldWVcclxuICAgICAgICAgICAgY3VzdG9tZXJJRHMuZm9yRWFjaChmdW5jdGlvbihpZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9yZGVyUXVldWVbaWRdID09PSBjaGVja2JveC5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vR2V0IEN1dG9tZXIgTmFtZSBhbmQgT3JkZXIgYmFzZWQgb24gaGlzIElEXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1c3RvbWVyRGF0YSA9IGN1c3RvbWVyT3JkZXJzW2lkXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VzdG9tZXJEYXRhQXJyYXkgPSBjdXN0b21lckRhdGEuc3BsaXQoXCIkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXN0b21lck5hbWUgPSBjdXN0b21lckRhdGFBcnJheVswXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYmV2ZXJhZ2UgPSBjdXN0b21lckRhdGFBcnJheVsxXTtcclxuICAgICAgICAgICAgICAgICAgICAvL1JPV1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXN0b21lclJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0clwiKTtcclxuICAgICAgICAgICAgICAgICAgICByb3dJRCA9IG9yZGVyUXVldWVbaWRdICsgXCJSb3dcIjtcclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChyb3dJRCkuYXBwZW5kQ2hpbGQoY3VzdG9tZXJSb3cpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vSURcclxuICAgICAgICAgICAgICAgICAgICB2YXIgSUQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgSUQuaW5uZXJIVE1MID0gaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tZXJSb3cuYXBwZW5kQ2hpbGQoSUQpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vTmFtZVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWUuaW5uZXJIVE1MID0gY3VzdG9tZXJOYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbWVyUm93LmFwcGVuZENoaWxkKG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vQmV2ZXJhZ2VcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZHJpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgZHJpbmsuaW5uZXJIVE1MID0gYmV2ZXJhZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tZXJSb3cuYXBwZW5kQ2hpbGQoZHJpbmspO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vQ2hlY2tCb3hcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0RGF0YSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3REYXRhLmlkID0gaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tZXJSb3cuYXBwZW5kQ2hpbGQoc2VsZWN0RGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlucHV0Q2hlY2tCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRDaGVja0JveC50eXBlID0gXCJjaGVja2JveFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGlucHV0Q2hlY2tCb3gubmFtZSA9IG9yZGVyUXVldWVbaWRdO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdERhdGEuYXBwZW5kQ2hpbGQoaW5wdXRDaGVja0JveCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9JZiBVbmNoZWNrZWRcclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIHJvd0lEID0gY2hlY2tib3guaWQgKyBcIlJvd1wiO1xyXG4gICAgICAgICAgICB2YXIgb3JkZXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocm93SUQpO1xyXG4gICAgICAgICAgICBvcmRlcnMucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIGNvdW50ID0gMDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5cclxuY29uc3QgaW5UaGVRdWV1ZUZ1bmN0aW9uID0gaGFuZGxlRGF0YShkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImluVGhlUXVldWVcIikpO1xyXG5jb25zdCBiZWluZ01peGVkRnVuY3Rpb24gPSBoYW5kbGVEYXRhKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmVpbmdNaXhlZFwiKSk7XHJcbmNvbnN0IHJlYWR5VG9Db2xsZWN0RnVuY3Rpb24gPSBoYW5kbGVEYXRhKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVhZHlUb0NvbGxlY3RcIikpO1xyXG5cclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpblRoZVF1ZXVlXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgaW5UaGVRdWV1ZUZ1bmN0aW9uKTtcclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiZWluZ01peGVkXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgYmVpbmdNaXhlZEZ1bmN0aW9uKTtcclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZWFkeVRvQ29sbGVjdFwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIHJlYWR5VG9Db2xsZWN0RnVuY3Rpb24pO1xyXG5cclxuXHJcblxyXG4vLyBTaGlmdCBhbGwgdGhlIGNoZWNrZWQgb3JkZXJzIHRvIHRoZSBzZWxlY3RlZCBRdWV1ZVxyXG5mdW5jdGlvbiBzaGlmdFRvU2VsZWN0ZWRRdWV1ZSgpIHtcclxuICAgIGRhdGFiYXNlLmNvbGxlY3Rpb24oXCJjdXN0b21lcnNcIikuZ2V0KCkudGhlbigoc25hcHNob3QpID0+IHtcclxuICAgICAgICBjb25zdCBkb2MgPSBzbmFwc2hvdC5kb2NzWzBdO1xyXG4gICAgICAgIGxldCBkb2NJZCA9IGRvYy5pZDtcclxuICAgICAgICBsZXQgY3VzdG9tZXJzRGF0YSA9IGRvYy5kYXRhKCkuY3VzdG9tZXJzRGF0YTtcclxuICAgICAgICBsZXQgY3VzdG9tZXJPcmRlcnMgPSBjdXN0b21lcnNEYXRhWzBdO1xyXG4gICAgICAgIGxldCBvcmRlclF1ZXVlID0gY3VzdG9tZXJzRGF0YVsxXTtcclxuICAgICAgICBsZXQgY3VycmVudEN1c3RvbWVyc0NvdW50ID0gZG9jLmRhdGEoKS5jdXJyZW50Q3VzdG9tZXJzQ291bnQ7XHJcbiAgICAgICAgbGV0IGluZGV4ID0gZG9jLmRhdGEoKS5pbmRleDtcclxuXHJcbiAgICAgICAgbGV0IHF1ZXVlTmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2hpZnRUb1F1ZXVlXCIpLnZhbHVlO1xyXG4gICAgICAgIGxldCBzZWxlY3RlZE9yZGVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFt0eXBlPSdjaGVja2JveCddOmNoZWNrZWRcIik7XHJcblxyXG4gICAgICAgIHNlbGVjdGVkT3JkZXJzLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlbGVtZW50LnBhcmVudEVsZW1lbnQuaWQgJiYgcXVldWVOYW1lICE9IFwiLS1TaGlmdCBUbyBRdWV1ZS0tXCIpIHtcclxuICAgICAgICAgICAgICAgIGxldCBjdXN0b21lcklkID0gZWxlbWVudC5wYXJlbnRFbGVtZW50LmlkO1xyXG4gICAgICAgICAgICAgICAgY3VzdG9tZXJJZCA9IHBhcnNlSW50KGN1c3RvbWVySWQpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChxdWV1ZU5hbWUgIT0gXCJkZWxldGVPcmRlclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9VcGRhdGUgdGhlIGN1c3RvbWVySWQgd2l0aCBuZXcgcXVldWVOYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG9yZGVyUXVldWVbY3VzdG9tZXJJZF07XHJcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJRdWV1ZVtpbmRleF0gPSBxdWV1ZU5hbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vRGVsZXRlIHRoZSBjdXN0b21lckRhdGEgYW5kIHVwZGF0ZSB0byBuZXcgb25lXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGN1c3RvbWVyRGF0YSA9IGN1c3RvbWVyT3JkZXJzW2N1c3RvbWVySWRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBjdXN0b21lck9yZGVyc1tjdXN0b21lcklkXTtcclxuICAgICAgICAgICAgICAgICAgICBjdXN0b21lck9yZGVyc1tpbmRleF0gPSBjdXN0b21lckRhdGE7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiY3VzdG9tZXJzRGF0YVwiLCBKU09OLnN0cmluZ2lmeShjdXN0b21lcnNEYXRhKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9VcGRhdGUgdGhlIGluZGV4IGNvdW50IGluIEZpcmVzdG9yZVxyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4KytcclxuICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImluZGV4XCIsIGluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhYmFzZS5jb2xsZWN0aW9uKFwiY3VzdG9tZXJzXCIpLmRvYyhkb2NJZCkudXBkYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tZXJzRGF0YTogY3VzdG9tZXJzRGF0YSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGluZGV4XHJcbiAgICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvL0RlbGV0ZSB0aGUgY3VzdG9tZXIncyBkYXRhIGZyb20gRmlyZXN0b3JlXHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGN1c3RvbWVyT3JkZXJzW2N1c3RvbWVySWRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBvcmRlclF1ZXVlW2N1c3RvbWVySWRdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1c3RvbWVyc0RhdGFcIiwgSlNPTi5zdHJpbmdpZnkoY3VzdG9tZXJzRGF0YSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDdXN0b21lcnNDb3VudC0tO1xyXG4gICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiY3VycmVudEN1c3RvbWVyc0NvdW50XCIsIGN1cnJlbnRDdXN0b21lcnNDb3VudCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFiYXNlLmNvbGxlY3Rpb24oXCJjdXN0b21lcnNcIikuZG9jKGRvY0lkKS51cGRhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXN0b21lcnNEYXRhOiBjdXN0b21lcnNEYXRhLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50Q3VzdG9tZXJzQ291bnQ6IGN1cnJlbnRDdXN0b21lcnNDb3VudFxyXG4gICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ1cGRhdGVMb2NhbFN0b3JhZ2VcIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHNoaWZ0VG9TZWxlY3RlZFF1ZXVlKTsiLCJpbXBvcnQgeyBkYXRhYmFzZSB9IGZyb20gJy4uL0luZGV4X1BhZ2UvZmlyZVN0b3JlQWNjZXNzLmpzJztcclxuZGF0YWJhc2UuY29sbGVjdGlvbihcImN1c3RvbWVyc1wiKS5nZXQoKS50aGVuKChzbmFwc2hvdCkgPT4ge1xyXG4gICAgY29uc3QgZG9jID0gc25hcHNob3QuZG9jc1swXTtcclxuICAgIGxldCBjdXN0b21lcnNEYXRhID0gZG9jLmRhdGEoKS5jdXN0b21lcnNEYXRhO1xyXG4gICAgbGV0IGN1cnJlbnRDdXN0b21lcnNDb3VudCA9IGRvYy5kYXRhKCkuY3VycmVudEN1c3RvbWVyc0NvdW50O1xyXG4gICAgbGV0IGluZGV4ID0gZG9jLmRhdGEoKS5pbmRleDtcclxuICAgIGFkZFRvTG9jYWxTdG9yYWdlKGN1c3RvbWVyc0RhdGEsIGN1cnJlbnRDdXN0b21lcnNDb3VudCwgaW5kZXgpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGFkZFRvTG9jYWxTdG9yYWdlKGN1c3RvbWVyc0RhdGEsIGN1cnJlbnRDdXN0b21lcnNDb3VudCwgaW5kZXgpIHtcclxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImN1c3RvbWVyc0RhdGFcIiwgSlNPTi5zdHJpbmdpZnkoY3VzdG9tZXJzRGF0YSkpO1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiaW5kZXhcIiwgaW5kZXgpO1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiY3VycmVudEN1c3RvbWVyc0NvdW50XCIsIGN1cnJlbnRDdXN0b21lcnNDb3VudCk7XHJcbiAgICB9XHJcbn0pOyIsIi8vIGV4dHJhY3RlZCBieSBtaW5pLWNzcy1leHRyYWN0LXBsdWdpblxuZXhwb3J0IHt9OyJdLCJzb3VyY2VSb290IjoiIn0=